<%- include('../../fragments/header.ejs') %>
<main>
    <h2><%= pageTitle %></h2>
    <form class="form" method="post" action="<%= formAction %>" onsubmit="return validateForm();" novalidate>
        <label for="IdDept"></label>
        <input type="hidden" name="IdDept" value="<%= dept.idDepartment %>">
        <label for="name">Department name:
            <% if(formMode != 'showDetails'){ %><span class="required-field">*</span>
            <% } %>
        </label>
        <input type="text" id="name" name="name" placeholder="Name"
               value="<%= dept.name %>" <%= (formMode == 'showDetails') ? 'disabled' : '' %> required>
        <span id="errorDeptName" class="errors-text"></span>
        <label for="location">Department location:
            <% if(formMode != 'showDetails'){ %><span class="required-field">*</span>
            <% } %>
        </label>
        <input type="text" id="location" name="location" placeholder="Location"
               value="<%= dept.location %>" <%= (formMode == 'showDetails') ? 'disabled' : '' %> required>
        <span id="errorDeptLoc" class="errors-text"></span>
        <% if(formMode == 'showDetails'){ %>
            <!--            <select name="contracts" id="contracts">-->
            <!--                <option disabled selected>&#45;&#45; Contracts &#45;&#45;</option>-->
            <!--                <% // for(let cont of contracts){ %>-->
            <!--                <% //console.log(contracts) %>-->
            <!--                <option value="<%//= cont.idContract %>" disabled>ID: <%=// cont.idContract %></option>-->
            <!--                <% //} %>-->
            <!--            </select>-->
            <div class="form-buttons">
                <a href="/departments/edit/<%= dept.idDepartment %>" class="list-actions-button-edit">
                    Edit
                </a>
            </div>
        <% } %>
        <div class="form-buttons">
            <% if (formMode != 'showDetails') { %>
                <input type="submit" value="<%= btnLabel %>" class="button-submit">
                <a href="/departments" class="button-cancel">
                    Cancel
                </a>
            <% } else { %>
                <a class="button-cancel" href="/departments">Go back</a>
            <% } %>
        </div>
    </form>
    <% if(formMode == 'showDetails'){ %>
        <h3>Contracts</h3>
        <table id="contracts" class="table-list-resDept">
        <thead>
        <tr>
            <th>ID</th>
            <th>Description</th>
        </tr>
        </thead>
        <tbody>
        <% if (contracts.length <= 0) { %>
            <tr>
                <td data-label="Department">-------------</td>
                <td data-label="Location">--------------</td>
            </tr>
        <% }else{for(let cont of contracts) { %>
            <tr>
                <td data-label="ID"><a href="/contracts_departments/details/<%=cont.idContract%>"><%= cont.idContract %></a></td>
                <td data-label="Description"><%= cont.description %></td>
            </tr>
        <% }} %>
        </tbody>
    </table>
    <%}%>

    <script type="application/javascript" src="../JS/ValidationCommon.js"></script>
    <script type="application/javascript" src="../JS/ValidationDept.js"></script>
</main>
<%- include('../../fragments/footer.ejs') %>